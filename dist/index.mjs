var S=e=>e instanceof Uint8Array;var A=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);var D=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!D)throw new Error("Non little-endian hardware is not supported");var q=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function N(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function d(e){if(typeof e=="string"&&(e=N(e)),!S(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var m=class{clone(){return this._cloneInto()}};function L(e){let t=n=>e().update(d(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}var g=class extends m{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){super();let n=d(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?t.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(t){return this.iHash.update(t),this}digestInto(t){this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=o,t.blockLen=s,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},x=(e,t,r)=>new g(e,t).update(r).digest();x.create=(e,t)=>new g(e,t);var v=(e,t,r)=>e&t|e&r|t&r,I=(e,t,r)=>e^t^r,F=(e,t,r)=>e&t|~e&r;function V(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,h=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+h,a,n)}function p(e,t){let r=t&31;return e<<r|e>>>32-r}function O(e){return e^p(e,9)^p(e,17)}function G(e){return e^p(e,15)^p(e,23)}var y=new Uint32Array([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214]),f=new Uint32Array(68),k=new Uint32Array(64),j=2043430169,P=2055708042,U=class{A=y[0]|0;B=y[1]|0;C=y[2]|0;D=y[3]|0;E=y[4]|0;F=y[5]|0;G=y[6]|0;H=y[7]|0;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;blockLen;outputLen;padOffset;isLE;constructor(){this.blockLen=64,this.outputLen=32,this.padOffset=8,this.isLE=!1,this.buffer=new Uint8Array(this.blockLen),this.view=A(this.buffer)}get(){let{A:t,B:r,C:n,D:i,E:o,F:s,G:a,H:c}=this;return[t,r,n,i,o,s,a,c]}set(t,r,n,i,o,s,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,r){for(let u=0;u<16;u++,r+=4)f[u]=t.getUint32(r,!1);for(let u=16;u<68;u++)f[u]=G(f[u-16]^f[u-9]^p(f[u-3],15))^p(f[u-13],7)^f[u-6];for(let u=0;u<64;u++)k[u]=f[u]^f[u+4];let{A:n,B:i,C:o,D:s,E:a,F:c,G:h,H:l}=this;for(let u=0;u<64;u++){let w=u>=0&&u<=15,E=w?j:P,T=p(p(n,12)+a+p(E,u),7),C=T^p(n,12),_=(w?I(n,i,o):v(n,i,o))+s+C+k[u]|0,M=(w?I(a,c,h):F(a,c,h))+l+T+f[u]|0;s=o,o=p(i,9),i=n,n=_,l=h,h=p(c,19),c=a,a=O(M)}n=n^this.A|0,i=i^this.B|0,o=o^this.C|0,s=s^this.D|0,a=a^this.E|0,c=c^this.F|0,h=h^this.G|0,l=l^this.H|0,this.set(n,i,o,s,a,c,h,l)}roundClean(){f.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}update(t){let{view:r,buffer:n,blockLen:i}=this;t=d(t);let o=t.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=A(t);for(;i<=o-s;s+=i)this.process(c,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let u=s;u<i;u++)r[u]=0;V(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=A(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let h=c/4,l=this.get();if(h>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<h;u++)a.setUint32(4*u,l[u],o)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return t.length=i,t.pos=a,t.finished=o,t.destroyed=s,i%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},B=L(()=>new U);var H=(e,t)=>x(B,e,t);var b=32;function K(e,t){return H(t,e)}function R(e,t,r=32){let n=new Uint8Array(b+t.length+1),i=Math.ceil(r/b),o=new Uint8Array(i*b);for(let s=0;s<i;s++)n.set(t,b),n.set([s+1],n.length-1),n.set(H(e,s==0?n.slice(b):n)),o.set(n.slice(0,b),s*b);return o.slice(0,r)}function $(e,t,r,n=32){t||(t=new Uint8Array(b).fill(0)),r||(r=new Uint8Array([]));let i=K(e,t);return R(i,r,n)}var ot=$;export{$ as HKDF,ot as default};
